# perfi
defi portfolio analytics

# About
An open source (AGPLv3), local/private tool to help track your defi degen escapades.

## DISCLAIMER
This software should not be used in lieu of accounting / tax review. In fact, the reports generated by this software are almost guaranteed to be incorrect without manual adjustments.

## 4/15 "horseshoe"
This initial release was created primarily to generate a "close enough" 8949-style output to give a ballpark estimate for tax prepayments for dealing with thousands of DeFi transactions from last year.

We started working on this in earnest after reviewing and finding existing tools and services didn't actually work well at all for active defi accounts.

### Requirements
It's currently in a pretty raw state and requires some technical know-how to run. You should have [Python 3.10](https://www.python.org/) and [Poetry](https://python-poetry.org/) installed.

perfi depends on several third party API providers, some of which require (free) API keys:
* [DeBank OpenAPI](https://open.debank.com/)
* [CoinGecko API](https://www.coingecko.com/en/api) ([paid API](https://www.coingecko.com/en/api/pricing) supported)
* [Etherscan](https://etherscan.io/) and friends (polygonscan, snowtrace, ftmscan)
* [Covalent](https://www.covalenthq.com/)

Here's how to install
```
git clone https://github.com/AUGMXNT/perfi
cd perfi
poetry install
```

And how to run:
```
# Configure perfi w/ you API keys, etc.
poetry run python bin/setup_perfi.py

# Run perfi
poetry run python bin/generate_all.py
```

This runs:
```
# Update Coingecko Price List
poetry run python bin/update_coingecko_pricelist.py

# Ingest Exchange Transactions
poetry run python bin/ingest_exchange_txs.py

# Ingest Onchain Transactions
poetry run python bin/ingest_chain_txs.py

# Generate tx/price asset mappings
poetry run python bin/map_assets.py

# Turn raw exchange/onchain txs into grouped ledger txs
poetry run python bin/group_transactions.py

# Generate Costbasis lots and disposals, output to spreadsheet
poetry run python bin/generate_costbasis.py
```

## Caveats
